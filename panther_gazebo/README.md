# panther_gazebo

The package contains a launch file and source files used to run the robot simulation in Gazebo. The simulator tries to reproduce the behavior of a real robot as much as possible, including the provision of an analogous ROS_API.

## Launch Files

- `spawn_robot.launch.py` - is responsible for spawning the robot in the simulator
- `simulate_robot.launch.py` - is responsible for giving birth to the robot and simulating its physical behavior, such as driving, displaying data, etc.
- `simulate_multiple_robots.launch.py` - similar to the above with logic allowing you to quickly add a swarm of robots
- **`simulation.launch.py`** - a target file that runs the gazebo simulator and adds and simulates the robot's behavior in accordance with the given arguments.

## Configuration Files

- [`battery_plugin_config.yaml`](./config/battery_plugin_config.yaml): simulated LinearBatteryPlugin configuration
- [`gz_bridge.yaml`](./config/gz_bridge.yaml): specify data to exchange between ROS and Gazebo simulation.
- [`led_strips.yaml`](./config/led_strips.yaml): configure properties of led strips in simulation to animate lights.

## ROS Nodes

| Node name                 | Description <br/> *Type*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| ------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `controller_manager`      | Controller Manager performs two main functions. First, it manages controllers and their required interfaces, handling tasks like loading, activating, deactivating, and unloading. Second, it interacts with hardware components, ensuring access to their interfaces. For more information, refer to  [controller_manager](https://control.ros.org/master/doc/ros2_control/controller_manager/doc/userdoc.html). This node manages the: `imu_broadcaster`, `joint_state_broadcaster`, `drive_controller` <br/> *[controller_manager/controller_manager](https://github.com/ros-controls/ros2_control/blob/master/controller_manager)* |
| `drive_controller`        | Manages mobile robots with a differential drive. It converts velocity commands for the robot body into wheel commands for the base. It also calculates odometry from hardware feedback and shares it. <br/> *[diff_drive_controller/diff_drive_controller](https://github.com/ros-controls/ros2_controllers/tree/master/diff_drive_controller)*                                                                                                                                                                                                                                                                                        |
| `ekf_filter`              | The Extended Kalman Filter node is designed to fuse odometry data from various sources, including wheel encoders, IMU, and GPS. <br/> *[robot_localization/ekf_filter](https://github.com/cra-ros-pkg/robot_localization)*                                                                                                                                                                                                                                                                                                                                                                                                             |
| `gz_ros2_control`         | Responsible for integrating the ros2_control controller architecture with the Gazebo simulator. <br/> [gz_ros2_control/gz_ros2_control](https://github.com/ros-controls/gz_ros2_control/tree/master/gz_ros2_control/src)                                                                                                                                                                                                                                                                                                                                                                                                               |
| `imu_broadcaster`         | Publishes readings of IMU sensors. <br/> *[imu_sensor_broadcaster/imu_sensor_broadcaster](https://github.com/ros-controls/ros2_controllers/tree/master/imu_sensor_broadcaster)*                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| `joint_state_broadcaster` | Reads all state interfaces and reports them on specific topics. <br/> *[joint_state_broadcaster/joint_state_broadcaster](https://github.com/ros-controls/ros2_controllers/tree/master/joint_state_broadcaster)*                                                                                                                                                                                                                                                                                                                                                                                                                        |
| `lights_container`        | Node for dynamically loadable components such as plugins <br/>[*rclcpp_components/component_container*](https://github.com/ros2/rclcpp/tree/rolling/rclcpp_components)                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `lights_controller`       | This node is responsible for processing animations and publishing frames to be displayed on the Husarion Panther robot Bumper Lights. <br/> [*panther_lights/ControllerNode*](./panther_lights)                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| `lights_manager`          | Node responsible for managing Bumper Lights animation scheduling. <br/> *[panther_manager/lights_manager_node](../panther_manager)*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `navsat_transform`        | It converts raw GPS data into odometry data and publishes corrected GPS positions based on sensor data at a higher frequency. <br/> *[robot_localization/navsat_transform](https://github.com/cra-ros-pkg/robot_localization)*                                                                                                                                                                                                                                                                                                                                                                                                         |
| `panther_base_gz_bridge`  | Convert and transmit data between ROS and Gazebo <br/> *[ros_gz_bridge/parameter_bridge](https://github.com/gazebosim/ros_gz/tree/ros2/ros_gz_bridge)*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `robot_state_publisher`   | Broadcasts a robot's state to tf2 using a provided URDF model and joint states. It updates the model and broadcasts poses for fixed and movable joints to tf2 topics. <br/> *[robot_state_publisher/robot_state_publisher](https://github.com/ros/robot_state_publisher)*                                                                                                                                                                                                                                                                                                                                                              |
