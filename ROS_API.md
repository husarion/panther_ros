# ROS API

| Color | Description                                              |
| ----- | -------------------------------------------------------- |
| ðŸŸ©     | Available both for hardware and simulation               |
| ðŸŸ§     | Available only in specific launch argument configuration |
| ðŸŸ¦     | Available only in simulation mode                        |

## Running Nodes

| Node                      | Description                                                                                                                                                                                                                                 |
| ------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `battery_node`            | Publishes battery state read from ADC unit for Panther version 1.2 and above, or based on Roboteq motor controllers' data for earlier versions of the robot.<br/> [*panther_batter/battery_node*](https://github.com/husarion/panther_ros/) |
| `controller_manager`      |                                                                                                                                                                                                                                             |
| `ekf_node`                | The Extended Kalman Filter node is designed to fuse odometry data from various sources, including wheel encoders, IMU, and GPS.<br/> [*robot_localization/ekf_node*](https://github.com/cra-ros-pkg/robot_localization)                    |
| `imu_broadcaster`         |                                                                                                                                                                                                                                             |
| `joint_state_broadcaster` |                                                                                                                                                                                                                                             |
| `lights_controller_node`  | <br/> [*panther_lights/lights_controller_node*](https://github.com/husarion/panther_ros/)                                                                                                                                                   |
| `lights_driver_node`      | <br/> [*panther_lights/lights_driver_node*](https://github.com/husarion/panther_ros/)                                                                                                                                                       |
| `lights_manager_node`     | <br/> [*panther_lights/lights_manager_node*](https://github.com/husarion/panther_ros/)                                                                                                                                                      |
| ðŸŸ§ `navsat_transform`      | It converts raw GPS data into odometry data and publishes corrected GPS positions based on sensor data at a higher frequency.  <br/> [*robot_localization/navsat_transform_node*](https://github.com/cra-ros-pkg/robot_localization)        |
| `panther_base_controller` |                                                                                                                                                                                                                                             |
| `panther_system_node`     |                                                                                                                                                                                                                                             |
| `robot_state_publisher`   |                                                                                                                                                                                                                                             |
| `safety_manager_node`     | <br/> [*panther_manager/safety_manager_node*](https://github.com/husarion/panther_ros/)                                                                                                                                                     |
| `system_status_node`      | <br/> [*panther_diagnostics/system_status_node*](https://github.com/husarion/panther_ros/)                                                                                                                                                  |

## Topics

| Topic                                      | Description                                                                                                                                                                                                                                                                                                                                                               |
| ------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `battery`                                  | Mean values of both batteries if Panther has two batteries. Otherwise, the state of the single battery will be published.<br/> [`sensor_msgs/BatteryState`](https://docs.ros2.org/latest/api/sensor_msgs/msg/BatteryState.html)                                                                                                                                           |
| `battery_1_raw`                            | First battery raw state.<br/> [`sensor_msgs/BatteryState`](https://docs.ros2.org/latest/api/sensor_msgs/msg/BatteryState.html)                                                                                                                                                                                                                                            |
| `battery_2_raw`                            | Second battery raw state. Published if second battery detected.<br/> [`sensor_msgs/BatteryState`](https://docs.ros2.org/latest/api/sensor_msgs/msg/BatteryState.html)                                                                                                                                                                                                     |
| `charging_status`                          | Battery charging status value.<br/> `panther_msgs/ChargingStatus`                                                                                                                                                                                                                                                                                                         |
| `cmd_vel`                                  | Command velocity value.<br/> [`geometry_msgs/Twist`](https://docs.ros2.org/latest/api/geometry_msgs/msg/Twist.html)                                                                                                                                                                                                                                                       |
| `diagnostics`                              | Diagnostic data.<br/> [`diagnostic_msgs/DiagnosticArray`](https://docs.ros2.org/latest/api/diagnostic_msgs/msg/DiagnosticArray.html)                                                                                                                                                                                                                                      |
| `driver/motor_controllers_state`           | Current motor controllers' state and error flags. Subscribed if using Roboteq motor controllers data.<br/> `panther_msgs/DriverState`                                                                                                                                                                                                                                     |
| `dynamic_joint_states`                     | Dynamic joint state information.<br/> [`control_msgs/DynamicJointState`](https://github.com/ros-controls/control_msgs/blob/master/control_msgs/msg/DynamicJointState.msg)                                                                                                                                                                                                 |
| `ekf_node/set_pose`                        | Set the pose of the EKF node.<br/> [`geometry_msgs/PoseWithCovarianceStamped`](https://docs.ros2.org/latest/api/geometry_msgs/msg/PoseWithCovarianceStamped.html)                                                                                                                                                                                                         |
| ðŸŸ§ `gps/fix`                                | Raw GPS data.<br/> [`sensor_msgs/NavSatFix`](https://docs.ros2.org/latest/api/sensor_msgs/msg/NavSatFix.html)                                                                                                                                                                                                                                                             |
| ðŸŸ§ `gps/filtered`                           | Filtered GPS position after fusing odometry data.<br/> [`sensor_msgs/NavSatFix`](https://docs.ros2.org/latest/api/sensor_msgs/msg/NavSatFix.html)                                                                                                                                                                                                                         |
| `hardware/e_stop`                          | Current E-stop state.<br/> `std_msgs/Bool`                                                                                                                                                                                                                                                                                                                                |
| `hardware/io_state`                        | Current IO state.<br/> `panther_msgs/IOState`                                                                                                                                                                                                                                                                                                                             |
| `imu/data`                                 | Filtered IMU data.<br/> [`sensor_msgs/Imu`](https://docs.ros2.org/latest/api/sensor_msgs/msg/Imu.html)                                                                                                                                                                                                                                                                    |
| `imu_broadcaster/imu`                      | <br/> [`sensor_msgs/Imu`](https://docs.ros2.org/latest/api/sensor_msgs/msg/Imu.html)                                                                                                                                                                                                                                                                                      |
| `imu_broadcaster/transition_event`         | <br/> [`lifecycle_msgs/TransitionEvent`](https://docs.ros2.org/latest/api/lifecycle_msgs/msg/TransitionEvent.html)                                                                                                                                                                                                                                                        |
| `joint_state_broadcaster/transition_event` | <br/> [`lifecycle_msgs/TransitionEvent`](https://docs.ros2.org/latest/api/lifecycle_msgs/msg/TransitionEvent.html)                                                                                                                                                                                                                                                        |
| `joint_states`                             | <br/> [`sensor_msgs/JointState`](https://docs.ros2.org/latest/api/sensor_msgs/msg/JointState.html)                                                                                                                                                                                                                                                                        |
| `lights/driver/channel_1_frame`            | <br/> [`sensor_msgs/Image`](https://docs.ros2.org/latest/api/sensor_msgs/msg/Image.html)                                                                                                                                                                                                                                                                                  |
| `lights/driver/channel_2_frame`            | <br/> [`sensor_msgs/Image`](https://docs.ros2.org/latest/api/sensor_msgs/msg/Image.html)                                                                                                                                                                                                                                                                                  |
| `odometry/filtered`                        | Contains information about the filtered position and orientation. When `localization_mode` is `relative`, the position and orientation are relative to the starting point. When `localization_mode` is `enu`, the orientation is relative to the east-north-up (ENU) coordinates.<br/> [`nav_msgs/Odometry`](https://docs.ros2.org/latest/api/nav_msgs/msg/Odometry.html) |
| `odometry/wheels`                          | Robot odometry calculated from wheels.<br/> [`nav_msgs/Odometry`](https://docs.ros2.org/latest/api/nav_msgs/msg/Odometry.html)                                                                                                                                                                                                                                            |
| `panther_base_controller/transition_event` | <br/> [`lifecycle_msgs/TransitionEvent`](https://docs.ros2.org/latest/api/lifecycle_msgs/msg/TransitionEvent.html)                                                                                                                                                                                                                                                        |
| `robot_description`                        | <br/> [`std_msgs/String`](https://docs.ros2.org/latest/api/std_msgs/msg/String.html)                                                                                                                                                                                                                                                                                      |
| `system_status`                            | <br/> `panther_msgs/SystemStatus`                                                                                                                                                                                                                                                                                                                                         |
| `tf`                                       | Transforms of robot system.<br/> [`tf2_msgs/TFMessage`](https://docs.ros2.org/latest/api/tf2_msgs/msg/TFMessage.html)                                                                                                                                                                                                                                                     |
| `tf_static`                                | <br/> [`tf2_msgs/TFMessage`](https://docs.ros2.org/latest/api/tf2_msgs/msg/TFMessage.html)                                                                                                                                                                                                                                                                                |

### Hidden topics

| Topic            | Description                                                                                                                          |
| ---------------- | ------------------------------------------------------------------------------------------------------------------------------------ |
| ðŸŸ§ `_odometry/gps` | Transformed raw GPS data to odometry format.<br/> [`nav_msgs/Odometry`](https://docs.ros2.org/latest/api/nav_msgs/msg/Odometry.html) |

## Services

| Service                                           | Description                                                     |
| ------------------------------------------------- | --------------------------------------------------------------- |
| `controller_manager/configure_controller`         | <br/> [controller_manager_msgs/srv/ConfigureController](https://github.com/ros-controls/ros2_control/tree/master/controller_manager_msgs)       |
| `controller_manager/list_controller_types`        | <br/> [controller_manager_msgs/srv/ListControllerTypes](https://github.com/ros-controls/ros2_control/tree/master/controller_manager_msgs)       |
| `controller_manager/list_controllers`             | <br/> [controller_manager_msgs/srv/ListControllers](https://github.com/ros-controls/ros2_control/tree/master/controller_manager_msgs)           |
| `controller_manager/list_hardware_components`     | <br/> [controller_manager_msgs/srv/ListHardwareComponents](https://github.com/ros-controls/ros2_control/tree/master/controller_manager_msgs)    |
| `controller_manager/list_hardware_interfaces`     | <br/> [controller_manager_msgs/srv/ListHardwareInterfaces](https://github.com/ros-controls/ros2_control/tree/master/controller_manager_msgs)    |
| `controller_manager/load_controller`              | <br/> [controller_manager_msgs/srv/LoadController](https://github.com/ros-controls/ros2_control/tree/master/controller_manager_msgs)            |
| `controller_manager/reload_controller_libraries`  | <br/> [controller_manager_msgs/srv/ReloadControllerLibraries](https://github.com/ros-controls/ros2_control/tree/master/controller_manager_msgs) |
| `controller_manager/set_hardware_component_state` | <br/> [controller_manager_msgs/srv/SetHardwareComponentState](https://github.com/ros-controls/ros2_control/tree/master/controller_manager_msgs) |
| `controller_manager/switch_controller`            | <br/> [controller_manager_msgs/srv/SwitchController](https://github.com/ros-controls/ros2_control/tree/master/controller_manager_msgs)          |
| `controller_manager/unload_controller`            | <br/> [controller_manager_msgs/srv/UnloadController](https://github.com/ros-controls/ros2_control/tree/master/controller_manager_msgs)          |
| `ekf_node/enable`                                 | Enable EKF node.<br/> [std_srvs/srv/Empty](https://docs.ros2.org/latest/api/std_srvs/srv/Empty.html)                                    |
| `ekf_node/set_pose`                               | Set pose of EKF node.<br/> [robot_localization/srv/SetPose](https://github.com/cra-ros-pkg/robot_localization/tree/ros2)                        |
| `ekf_node/toggle`                                 | Toggle filter processing in the EKF node.<br/> [robot_localization/srv/ToggleFilterProcessing](https://github.com/cra-ros-pkg/robot_localization/tree/ros2)         |
| `hardware/aux_power_enable`                       | Enables or disables AUX power.<br/> [std_srvs/srv/SetBool](https://docs.ros2.org/latest/api/std_srvs/srv/SetBool.html)                                  |
| `hardware/charger_enable`                         | Enables or disables charger.<br/> [std_srvs/srv/SetBool](https://docs.ros2.org/latest/api/std_srvs/srv/SetBool.html)                                   |
| `hardware/digital_power_enable`                   | Enables or disables digital power.<br/> [std_srvs/srv/SetBool](https://docs.ros2.org/latest/api/std_srvs/srv/SetBool.html)                                   |
| `hardware/e_stop_reset`                           | Resets E-stop.<br/> [std_srvs/srv/Trigger](https://docs.ros2.org/latest/api/std_srvs/srv/Trigger.html)                                  |
| `hardware/e_stop_trigger`                         | Triggers E-stop.<br/> [std_srvs/srv/Trigger](https://docs.ros2.org/latest/api/std_srvs/srv/Trigger.html)                                  |
| `hardware/fan_enable`                             | Enables or disables fan.<br/> [std_srvs/srv/SetBool](https://docs.ros2.org/latest/api/std_srvs/srv/SetBool.html)                                   |
| `hardware/motor_power_enable`                     | Enables or disables motor power.<br/> [std_srvs/srv/SetBool](https://docs.ros2.org/latest/api/std_srvs/srv/SetBool.html)                                   |
| `lights/controller/set/animation`                 | Sets LED animation.<br/> [panther_msgs/srv/SetLEDAnimation](https://github.com/husarion/panther_msgs)                      |
| `lights/driver/set/brightness`                    | Sets LED brightness.<br/> [panther_msgs/srv/SetLEDBrightness](https://github.com/husarion/panther_msgs)                     |
